<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>[% name %]</name>
      [% FOR style IN styles %]
        <Style id="[% style.colour_name %]">
          <LineStyle>
            <width>3</width>
            <color>[% style.line_colour %]</color>
          </LineStyle>
          <PolyStyle>
            <color>[% style.poly_colour %]</color>
          </PolyStyle>
        </Style>
      [% END %]
      [% FOREACH poly IN polygons %]
        <Placemark>
          <name>[% poly.name %]</name>
          <description>[% poly.title %]</description>
          <styleUrl>#[% poly.colour_name %]</styleUrl>
          <Polygon>
            <outerBoundaryIs>
              <LinearRing>
                <coordinates>
                  [% FOREACH point IN poly.points -%]
                    [% point.lng %],[% point.lat %],0
                  [% END %]
                </coordinates>
              </LinearRing>
            </outerBoundaryIs>
          </Polygon>
        </Placemark>
      [% END %]
  </Document>
</kml>
